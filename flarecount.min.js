!function(){const e=document.currentScript,t=e.getAttribute("data-busuanzi-mode"),i=e.getAttribute("data-base-url"),n={};t?(n.page_pv_id="busuanzi_value_page_pv",n.page_uv_id="busuanzi_value_page_uv",n.site_pv_id="busuanzi_value_site_pv",n.site_uv_id="busuanzi_value_site_uv"):(n.page_pv_id="page_pv",n.page_uv_id="page_uv",n.site_pv_id="site_pv",n.site_uv_id="site_uv"),n.init=async function(){const e=function(e){const t=document.createElement("a");return t.href=e,t}(window.location.href),t=document.querySelector(`#${n.page_pv_id}`),u=document.querySelector(`#${n.page_uv_id}`),o=document.querySelector(`#${n.site_pv_id}`),r=document.querySelector(`#${n.site_uv_id}`),a={url:e.pathname,hostname:e.hostname,referrer:document.referrer};let _;t&&(a.page_pv=!0),u&&(a.page_uv=!0),o&&(a.site_pv=!0),r&&(a.site_uv=!0),await(_=`${i}/api/visit`,new Promise(e=>{fetch(_,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(e=>e.json()).then(function(t){e(t)}).catch(e=>{console.error(e)})})).then(e=>{if("OK"!=e.ret)return void console.error("flarecount.init error",e.message);const i=e.data;t&&(t.innerText=i.page_pv),u&&(u.innerText=i.page_uv),o&&(o.innerText=i.site_pv),r&&(r.innerText=i.site_uv)}).catch(e=>{console.log("flarecount.init fetch error",e)})},"undefined"!=typeof window&&(n.init(),window.flarecount=n),console.info("count success. xiaoyezi.")}();
